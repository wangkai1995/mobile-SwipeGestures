function Swipe(e){function t(e){return"undefined"==typeof e}function i(e,t){u.dom.setAttribute("style","-webkit-transform: translate3d("+e+"px, 0px, 0px); transition-duration :"+t+"ms;")}function l(e){var t=0;return e-w.x>0?0===x.x?(t=e-w.x,x.x=e):(t=e-x.x,x.x=e):0===x.x?(t=Math.abs(e)-Math.abs(w.x),x.x=e):(t=Math.abs(e)-Math.abs(x.x),x.x=e),t}function o(e){var t=e;return t>0?t=0:Math.abs(t)+v.totalWidth>k.totalWidth&&(t=-(k.totalWidth-v.totalWidth)),t}function a(e){var t=e;return t-f.rollBack>0?t=f.rollBack:-t+v.totalWidth-f.rollBack>k.totalWidth&&(t=-(k.totalWidth-v.totalWidth)-f.rollBack),t}function n(e,t){return e+f.rollBack>t?e=t-f.rollBack:-e+f.rollBack>t&&(e=-(t-f.rollBack)),e}function s(e){u.war=document.querySelectorAll(".swipe-war")[0],u.dom=document.querySelectorAll(".swipe-container")[0],u.height=u.dom.clientHeight,u.width=u.dom.clientWidth,k.dom=document.querySelectorAll(".swipe-container .swipe-item"),k.length=k.dom.length;for(var t=0,i=k.dom.length;t<i;t++)k.totalWidth+=k.dom[t].clientWidth;console.log(f),console.log(u),console.log(k),console.log(v),d()}function d(){u.war.addEventListener("touchstart",c,!1),u.war.addEventListener("touchmove",r,!1),u.war.addEventListener("touchend",h,!1)}function c(e){e.stopPropagation(),e.preventDefault(),w.x=e.changedTouches[0].clientX,w.y=e.changedTouches[0].clientY,w.time=(new Date).getTime(),x.x=0,x.y=0}function r(e){e.stopPropagation(),e.preventDefault();var t=e.changedTouches[0].clientX,i=e.changedTouches[0].clientY;f.pressSwipeFlag&&(f.inlineMode?p.pressSwipe(t,i):S.pressSwipe(t,i))}function h(e){e.stopPropagation(),e.preventDefault(),g.x=e.changedTouches[0].clientX,g.y=e.changedTouches[0].clientY,g.time=(new Date).getTime(),f.inlineMode?p.letGoSwipe():S.letGoSwipe()}var m={},f={quickIsSlowDelay:t(e.quickIsSlowDelay)?300:e.quickIsSlowDelay,slideTime:t(e.slideTime)?500:e.slideTime,rollBack:t(e.rollBack)?100:e.rollBack,rollBackDelay:t(e.rollBackDelay)?300:e.rollBackDelay,pressSwipeFlag:!!t(e.pressSwipeFlag)||e.pressSwipeFlag,slowSlideFlag:!t(e.pressSwipeFlag),inlineMode:!t(e.inlineMode)&&e.inlineMode,blockSlideLimit:t(e.blockSlideLimit)?.3:e.blockSlideLimit},v={totalWidth:window.screen.width,halfWidth:window.screen.width/2},u={war:"",dom:"",height:0,width:0,moveLeft:0,moveTop:0},k={dom:"",length:0,totalWidth:0},w={x:0,y:0,time:0},x={x:0,y:0},g={x:0,y:0,time:0};m.getMoveValue=function(){return u.moveLeft},m.getBlockIndex=function(){return f.inlineMode?void console.log("必须处于块移动模式","swipe"):S.index},m.setMoveValue=function(e,t){if("number"==typeof e){if(e>0)return console.log("输入值大于零则默认等于0","swipe"),e=0,u.moveLeft=e,i(u.moveLeft,f.rollBackDelay),!1;if(e<-(k.totalWidth-k.dom[k.length-1].clientWidth))return console.log("输入值最小不能小于item集合的总长度","swipe"),e=-(k.totalWidth-k.dom[k.length-1].clientWidth),u.moveLeft=e,i(u.moveLeft,f.rollBackDelay),!1;if(t&&!f.inlineMode)for(var l=0,o=0;o<k.length;o++){if(Math.abs(e)<l)return k.dom[o].clientWidth-(l-Math.abs(e))>k.dom[o-1].clientWidth*f.blockSlideLimit?(u.moveLeft=-l,i(u.moveLeft,f.rollBackDelay),S.index=o):(u.moveLeft=-(l-k.dom[o-1].clientWidth),i(u.moveLeft,f.rollBackDelay),S.index=o-1),!1;l+=k.dom[o].clientWidth}else u.moveLeft=e,i(u.moveLeft,f.rollBackDelay)}else console.log("输入值必须是数值类型","swipe")},m.resetConfig=function(e,i){f.quickIsSlowDelay=t(e.quickIsSlowDelay)?f.quickIsSlowDelay:e.quickIsSlowDelay,f.slideTime=t(e.slideTime)?f.slideTime:e.slideTime,f.rollBack=t(e.rollBack)?f.rollBack:e.rollBack,f.rollBackDelay=t(e.rollBackDelay)?f.rollBackDelay:e.rollBackDelay,f.pressSwipeFlag=t(e.pressSwipeFlag)?f.pressSwipeFlag:e.pressSwipeFlag,f.slowSlideFlag=t(e.slowSlideFlag)?f.slowSlideFlag:e.slowSlideFlag,f.inlineMode=t(e.inlineMode)?f.inlineMode:e.inlineMode,f.blockSlideLimit=t(e.blockSlideLimit)?f.blockSlideLimit:e.blockSlideLimit,i&&s()};var p={pressSwipe:function(e,t){Math.abs(e-w.x)>Math.abs(t-w.y)&&(u.moveLeft+=l(e),u.moveLeft=a(u.moveLeft),i(u.moveLeft,f.rollBackDelay))},letGoSwipe:function(){var e=g.time-w.time;e<f.quickIsSlowDelay?this.quickSlide():f.slowSlideFlag?this.slowSlide():this.rollBackSlide()},quickSlide:function(){var e=g.x-w.x,t=g.y-w.y;Math.abs(e)>Math.abs(t)&&(u.moveLeft+=2*e,u.moveLeft=o(u.moveLeft),i(u.moveLeft,f.rollBackDelay))},slowSlide:function(){var e=g.x-w.x,t=g.y-w.y;Math.abs(e)>Math.abs(t)&&(u.moveLeft+=e+e/5,u.moveLeft=o(u.moveLeft),i(u.moveLeft,f.rollBackDelay))},rollBackSlide:function(){var e=g.x-w.x,t=g.y-w.y;Math.abs(e)>Math.abs(t)&&(u.moveLeft=o(u.moveLeft),i(u.moveLeft,f.rollBackDelay))}},S={index:0,moveleft:0,pressSwipe:function(e,t){if(Math.abs(e-w.x)>Math.abs(t-w.y)){this.moveleft+=l(e);var o=k.dom[this.index].clientWidth;this.moveleft=n(this.moveleft,o),i(u.moveLeft+this.moveleft,f.rollBackDelay)}},letGoSwipe:function(){var e=g.time-w.time;e<f.quickIsSlowDelay?this.quickSlide():this.rollBackSlide(),this.moveleft=0},quickSlide:function(){var e=g.x-w.x,t=g.y-w.y;Math.abs(e)>Math.abs(t)&&(u.moveLeft=this.slideMove(!1,e),u.moveLeft=o(u.moveLeft),i(u.moveLeft,f.rollBackDelay))},rollBackSlide:function(){var e=g.x-w.x,t=g.y-w.y;Math.abs(e)>Math.abs(t)&&(u.moveLeft=this.slideMove(!0,e,this.moveleft),u.moveLeft=o(u.moveLeft),i(u.moveLeft,f.rollBackDelay))},slideMove:function(e,t,i){var l=u.moveLeft,o=0;if(e){if(Math.abs(i)>k.dom[this.index].clientWidth*f.blockSlideLimit){n=0===this.index?1:this.index+1;for(var a=0;a<n;a++)o+=k.dom[a].clientWidth;t>0?(l+=o-Math.abs(u.moveLeft),this.index--,this.index<0&&(this.index=0)):(l-=o-Math.abs(u.moveLeft),this.index++,this.index>k.length-1&&(this.index=k.length-1))}}else if(f.pressSwipeFlag){for(var n=0===this.index?1:this.index+1,a=0;a<n;a++)o+=k.dom[a].clientWidth;t>0?(l+=o-Math.abs(u.moveLeft),this.index--,this.index<0&&(this.index=0)):(l-=o-Math.abs(u.moveLeft),this.index++,this.index>k.length-1&&(this.index=k.length-1))}else o=k.dom[this.index].clientWidth,t>0?(l+=o,this.index--,this.index<0&&(this.index=0)):(l-=o,this.index++,this.index>k.length-1&&(this.index=k.length-1));return l}};return s(),m}window.onload=function(){var e=Swipe({rollBack:150});setTimeout(function(){e.setMoveValue(-1690,!0),console.log(e.getMoveValue()),console.log(e.getBlockIndex())},2e3)};